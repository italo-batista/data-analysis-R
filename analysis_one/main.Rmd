---
title: "Analysing IMDB users ratings for series"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r include = FALSE, results = 'hide', echo=FALSE}
library("tidyverse")
```
```{r include = FALSE, results = 'hide', echo=FALSE}
library("tidyr")
library("dplyr")
library("ggplot2")
library("readr")
```

### Understanding data

Loading data:
```{r results='hide', warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}
dados = read_csv(file = "series_from_imdb.csv")
```


Esses dados, extraídos do site IMDB, são referentes às avaliações que usuários deram a episódies das séries que assistiram.
Os dados têm a seguinte estrutura:

```some_language
* $ series_name <chr> Auto-explicativo.
* $ series_ep   <int> O número do episódio na série desde o primeiro.
* $ season      <int> O número da temporada, começando em 1.
* $ season_ep   <int> Número do episódio na série.
* $ url         <chr> Url do IMDB para o episódio (eg "http://www.imdb.com/title/tt5174246/")
* $ Episode     <chr> Título do episódio.
* $ UserRating  <dbl> Avaliação geral para o episódio, calculado [como explicado em](http://www.imdb.com/help/show_leaf?votestopfaq).
* $ UserVotes   <dbl> Número de votos para o episódio.
* $ r1          <dbl> Proporção de avaliações dadas por usuários com nota 1
* $ r2          <dbl> Proporção de avaliações dadas por usuários com nota 2
* ...
* $ r10         <dbl> Proporção de avaliações dadas por usuários com nota 10
```

Para esta análise, usaremos os dados das seguintes séries:
  - Sense8
  - Stranger Things
  - Black Mirror
  - The Simpsons
  - Game of Thrones
  
```{r pressure, echo=FALSE}
dados = dados %>% filter(series_name %in% c("Black Mirror",
                                    "Game of Thrones",
                                    "Stranger Things",
                                    "Sense8",
                                    "The Simpsons"))
```


É preciso filtrar os dados da série The Simpsons para pegar apenas os anterior ao episódio número 204, pois a partir deste o número da temporado está calculado errado.
```{r}
dados = dados %>% filter(series_ep < 204)
```


Antes de começarmos a analisar os dados, é interessante saber saber como os dados se comportam, a fim de verificar se há existência de valores estranhos ou muito dispersos ou muito frequentes. Para tanto, iremos plotar um histograma para visualizar como os dados se comportam.

```{r}
dados %>% 
  mutate(Serie = as.character(series_name)) %>% 
  ggplot(mapping = aes(x = series_ep, y = UserRating, color = Serie)) + 
  geom_point( alpha = 0.6) +
  xlab("Episode index in the series from 1 onwards") + 
  ylab("Episode rating")
```


O aspecto visual que mais chama a atenção neste gráfico é que The Simpsons parece trilhar um caminho próprio no quesito comportamento. Esta série tem um número de episódios quase dez vezes maior que o das outras séries, além de, a partir de algum momento do tempo, ter uma concentração de avaliações de episódios abaixo da maioria dos episódios das outras séries, com algumas avaliações ainda mais abaixo.
As outras séries parecem variar menos entre si. Para visualiar melhor, talvez seja necessária plotar o mesmo gráfico, mas sem os dados da série The Simpsons.

```{r}
dados %>% 
  filter(series_name !="The Simpsons") %>%
  mutate(Serie = as.character(series_name)) %>% 
  ggplot(mapping = aes(x = series_ep, y = UserRating, color = Serie)) + 
  geom_point() +
  xlab("Episode index in the series from 1 onwards") + 
  ylab("Episode rating")
```



As outras séries parecem variar menos que The Simpsons, além de concentrarem uma maioria de avaliações acima de 8. De pouco mais de 100 episódios ao todo, apenas três estão abaixo de 8.0.

## Checkpoint 1


### Entre as séries, qual a melhor avaliada no IMDB? A diferença é grande? Pequena? 

Utilizando a avaliação geral por episódio calculada pelo IMDB, podemos discutir os seguintes pontos:

```{r}
dados %>% 
    mutate(serie = as.character(series_name)) %>% 
    ggplot( aes(x = serie, y = UserRating, color = serie) ) + 
    geom_point(alpha = 0.5) + 
    geom_jitter(width = .4) +
    stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median, geom = "crossbar", width = 0.9, color = "blue")
```

No gráfico acima, a linha azul identifica a mediana da avaliação para cada série. A partir deste gráfico, identificamos que Game of Thrones (GoT), Sense8 e Stranger Things competem entre as melhores, pois 50% dos episódios dessas séries são melhor avaliados que a maioria dos episódios de Black Mirror de The Simpsons.
Vamos analisar mais de perto os dados das séries que concorrem em primeiro:


Talvez seja apropriado analisar a proporção de pessoas que deram avaliações mais altas.

```{r}

```



---
Há alguma correlação entre a avaliação do usuário e o número do episódio ao longo de toda série?
Os últimos episódios de uma temporada costumam ser melhor avaliados?
Séries com mamis temporadas têm melhores avaliações (e por isso foram renovadas mais vezes?)
Temporadas mais longas são melhor ou pior avaliadas?



